@model  LkUgtu.Models.IndexTrudousrDTO
<div class="panel panel-success">
    <div class="panel-heading">
        <h3 style="margin: 0;">
            Трудоустройство
        </h3>
    </div>
    <div class="panel-body" style="padding: 0;">
        <div class="centered" style="background-color: #f5f5f5">
            <ul class="nav nav-justified">
                <li>
                    <a style="padding: 5px" title="Добавить трудоустройсво" class="btn btn-link btn-sm"><span class="glyphicon glyphicon-plus"></span></a>
                </li>
                <li id="buttViewTrudoustrList">
                    <a style="padding: 5px" title="Все мои трудоустройства" class="btn btn-link btn-sm"><span class="glyphicon glyphicon-eye-open"></span></a>
                </li>
                <!--<li>
                    <a style="padding: 5px" title="Внести поправку к уже имеющимся трудоустройствам" class="btn btn-link btn-sm"><span class="glyphicon glyphicon-cog"></span></a>
                </li>-->
            </ul>
        </div>
        <div class="panel-body" style="padding-bottom: 5px">
            <p>Общее число трудоустройств: @Model.countTridoustr </p>
            <p>Общее число практик: @Model.countPraktik</p>
        </div>
    </div>
</div>

<script>

    $('#buttViewTrudoustrList').click(function () {
        var url = "@Url.Action("GetModalViewTrudoustrList")";
        $.get(url, function (data) {
            $('#myModal').html(data);
            $('#myModal').appendTo('body').modal('show');
            //$('#tableVakansList')
            //    .append(
            //    $(document.createElement('div')).attr({
            //        class:'progress'
            //    })
            //        .append(
            //            $(document.createElement('div')).attr({
            //                class: 'progress-bar progress-bar-striped active'
            //                ,role: 'progressbar'
            //                ,'aria-valuenow': '50'
            //                ,'aria-valuemin': '0'
            //                ,'aria-valuemax': '100'
            //                ,style:'width:50%'
            //            }).html('50%')));
            $.ajax({
                url: '@Url.Action("GetAllTrudoustr")',
                data: { idStud: '24611' },
                contentType: "application/json",
                dataType: "json",
                success: function (tr) {
                    for (var i = 0; i < tr.length; i++) {
                        $('#tableTrudoustrList')
                             .append(
                             $(document.createElement('tr'))
                               .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('a')).attr({
                                         'class': 'glyphicon glyphicon-pencil editTrud'
                                         ,data:tr[i].idTrud
                                     })))
                                  .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html(i + ". " + tr[i].post)))
                                  .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html(tr[i].company)))
                                  .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html((tr[i].department == null) ? '' : tr[i].department)))
                                  .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html((tr[i].dateStart == null) ? '' : new Date(parseInt(tr[i].dateStart.substr(6))).toLocaleDateString() + ' - ' + new Date(parseInt(tr[i].dateStop.substr(6))).toLocaleDateString())))
                                  .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html(tr[i].salary)))
                                        .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html(tr[i].otherInfo)))
                                 .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html(new Date(parseInt(tr[i].dateCall.substr(6))).toLocaleDateString())))
                                .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html((tr[i].isWorkSpecialty)?'Да':'Нет')))
                                .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html((tr[i].withSpravka)?'Да':'Нет')))
                                .append(
                                 $(document.createElement('td'))
                                     .append(
                                     $(document.createElement('span')).html((tr[i].isPractik)?'Да':'Нет'))));

                    }
                }
            });

        });
    });
    $(document).on('click', '.editTrud', function () {
        var idt = $(this).attr('data');
        var url = "@Url.Action("GetModalViewTrudoustrEdit")";
        $.get(url, function (data) {
            $('#myModalEdit').html(data);
            $('#myModalEdit').appendTo('body').modal('show');
        });

        $.ajax({
            url: '@Url.Action("GetTrudoustr")',
            data: { idTrud: idt },
            contentType: "application/json",
            dataType: "json",
            success: function (t) {
                alert(JSON.stringify(t));
            }
        });

    });
</script>